<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
    <Dialog
        id="EditUserDialog"
        title="Editar Usuario"
        icon="sap-icon://edit"
        type="Message"
        class="customDialogSize"
        draggable="true"
        resizable="true"
    >
        <VBox id="EditUserDialogVbox" class="sapUiSmallMargin">
            <Input id="inputEditUserId" placeholder="ID de Usuario (texto)" value="{editUserModel>/USERID}" editable="true"/>

            <Input
                id="inputEditUsername"
                placeholder="Nombre Completo (obligatorio)"
                value="{editUserModel>/USERNAME}"
                required="true"
                valueStateText="Obligatorio" />
            
            <Label text="Número telefónico (10 dígitos)" labelFor="editPhoneDigit0"/>
            <HBox>
                <Input id="editPhoneDigit0" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/0}" type="Number" />
                <Input id="editPhoneDigit1" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/1}" type="Number" />
                <Input id="editPhoneDigit2" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/2}" type="Number" />
                <Input id="editPhoneDigit3" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/3}" type="Number" />
                <Input id="editPhoneDigit4" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/4}" type="Number" />
                <Input id="editPhoneDigit5" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/5}" type="Number" />
                <Input id="editPhoneDigit6" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/6}" type="Number" />
                <Input id="editPhoneDigit7" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/7}" type="Number" />
                <Input id="editPhoneDigit8" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/8}" type="Number" />
                <Input id="editPhoneDigit9" width="2em" maxLength="1" liveChange="onEditPhoneDigitChange" value="{editUserModel>/PHONE_DIGITS/9}" type="Number" />
            </HBox>
     
            <Input
                id="inputEditUserEmail"
                placeholder="Correo Electrónico (ejemplo@dominio.com, obligatorio)"
                value="{editUserModel>/EMAIL}"
                required="true"
                valueState="{= ${editUserModel>/EMAIL_ERROR} ? 'Error' : 'None' }"
                valueStateText="{editUserModel>/EMAIL_ERROR}"
                liveChange="onEditEmailInputChange" />

            <DatePicker id="inputEditUserBirthdayDate" placeholder="Fecha de nacimiento (YYYY-MM-DD)" value="{editUserModel>/BIRTHDAYDATE}" />

            <!-- ComboBox de compañías -->
            <ComboBox
                id="comboBoxEditCompanies"
                items="{editCompanies>/companies}"
                selectionChange="onEditCompanySelected"
                required="true"
                placeholder="Selecciona una empresa"
                selectedKey="{editUserModel>/COMPANYID}">
              <core:Item
                  key="{editCompanies>COMPANYID}"
                  text="{editCompanies>VALUE}" />
            </ComboBox>
            
            <!-- ComboBox de CEDIS (habilitado solo si hay datos) -->
            <ComboBox
                id="comboBoxEditCedis"
                items="{editCedis>/cedis}"
                selectionChange="onEditCediSelected"
                enabled="{= ${editCedis>/cedis}.length > 0 }"
                required="true"
                placeholder="Selecciona un CEDI"
                selectedKey="{editUserModel>/CEDIID}">
              <core:Item
                  key="{editCedis>CEDIID}"
                  text="{editCedis>CEDIIDLABEL}" />
            </ComboBox>

            <!-- ComboBox de Departamentos (habilitado solo si hay datos) -->
            <ComboBox
                id="comboBoxEditDepartments"
                items="{editDepartments>/departments}"
                selectionChange="onEditDepartmentSelected"
                enabled="{= ${editDepartments>/departments}.length > 0 }"
                required="true"
                placeholder="Selecciona un departamento"
                selectedKey="{editUserModel>/DEPARTMENTID}">
              <core:Item
                  key="{editDepartments>DEPARTMENTID}"
                  text="{editDepartments>DEPARTMENTNAME}" />
            </ComboBox>

            <ComboBox id="comboBoxEditRoles" items="{roles>/roles}" selectionChange="onRoleSelected" placeholder="Selecciona un Rol">
                <core:Item key="{roles>ROLEID}" text="{roles>ROLENAME}" />
            </ComboBox>
            
            <VBox id="selectedEditRolesVBox" class="sapUiSmallMarginTop">
                <!--VBOx donde va añadiendo los roles -->
            </VBox>

            <Input id="inputEditUserFunction" placeholder="Función que ejerce"/>

         
            <Text id="editPhoneErrorText" text="{editUserModel>/PHONE_ERROR}" visible="{= !!${editUserModel>/PHONE_ERROR} }" design="Negative"/>

        </VBox>

        <beginButton>
            <Button id="EditUser" text="Guardar" type="Emphasized" press="onEditSaveUser" />
        </beginButton>

        <endButton>
            <Button id="CancelEditUser" text="Cancelar" press="onEditCancelUser" />
        </endButton>
    </Dialog>
</core:FragmentDefinition>
